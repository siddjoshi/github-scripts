import concurrent.futures
from typing import Any, Callable, Dict, Iterable, List, Tuple


def run_in_parallel(
    items: Iterable[Any],
    worker: Callable[[Any], Tuple[str, Dict]],
    max_workers: int = 10,
) -> List[Tuple[str, Dict]]:
    """
    Execute worker over items in parallel.
    Worker must return (item_id, result_dict).
    """
    results: List[Tuple[str, Dict]] = []
    with concurrent.futures.ThreadPoolExecutor(max_workers=max_workers) as executor:
        future_to_item = {executor.submit(worker, item): item for item in items}
        for future in concurrent.futures.as_completed(future_to_item):
            item = future_to_item[future]
            try:
                data = future.result()
                results.append(data)
            except Exception as exc:
                results.append((str(item), {"error": str(exc)}))
    return results

